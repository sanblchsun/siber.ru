'use strict';
$(document).ready(function($) {


	// управление высотой
	// ==================
	var $mapBlock = $('.map');
	var $mapWrap  = $('.map-wrapper');
	var topMargin = $('.map-content').height();
	var mapResize = function(){
		$mapWrap.css({
			height: $mapBlock.height() - topMargin + 'px'
		});
	};

	window.addEventListener('resize', mapResize, false);
	mapResize();


	//==========================================
	var $icon  = $('.map-icon__item');
	var $plank = $('.map-hidden');
	var $wrap  = $('.map-wrapper');

	var showPlank = function(){
		var $self = $(this);
		var index = $self.data('number');
		var $activePlank = $('.map-hidden--'+index);

		if (!$self.hasClass('active')) {
			hidePlanks();
			$self.addClass('active');
			$activePlank.addClass('active');
			$wrap.addClass('-hide-bg');
		} else {
			hidePlanks();
		}
	};
	var hidePlanks = function(){
		$plank.removeClass('active');
		$icon.removeClass('active');
		$wrap.removeClass('-hide-bg');
	};

	$icon.on('click', showPlank);

	$(document).keydown(function(e) {
		if (e.keyCode === 27) {
			hidePlanks();
		}
	});
	$(document).on('click', function(event) {
		if ($(event.target).closest('.map-icon__item').length == 0
			&& !$(event.target).hasClass('map-icon__item')) {
			hidePlanks();
		}
	});
	// $icon.on('mouseover', showPlank);
	// $icon.on('mouseout', hidePlanks);

	$(window).on('scroll', hidePlanks);


	var resizeMap = function(event){
		var wHeight = $(window).height();
		var wWidth  = $(window).width();


		if (wWidth >= 1000) {
			$('.dragscroll').scrollLeft(0);
			$('.dragscroll').scrollTop(100);
		}

		if (wWidth < 992) {
			$('.dragscroll').scrollLeft(0);
			$('.dragscroll').scrollTop(100);

		}

		if (wWidth < 768) {
			$('.dragscroll').scrollLeft(100);
			$('.dragscroll').scrollTop(100);

		}

		if (wWidth < 600) {
			$('.dragscroll').scrollLeft(100);
			$('.dragscroll').scrollTop(100);

		}
	};
	window.addEventListener('resize', resizeMap, false);

	resizeMap();

});