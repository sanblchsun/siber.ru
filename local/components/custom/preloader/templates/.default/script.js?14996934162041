'use strict';
jQuery(document).ready(function($) {

	var $preloader       = $('.global-preloader');
	var $preloadFill     = $('.global-preloader__logo-fill');
	var video            = document.querySelector('#main-video');

	// блокировка прокрутки
	// ====================
	// var scrollLock = true;
	// $(document).on('scroll', function(event) {
	// 	console.log(scrollLock);
	// 	if (scrollLock) {
	// 		event.preventDefault();
	// 		return false;
	// 	}
	// });

	// window.addEventListener('scroll', function(){
	// 	console.log(111);
	// 	return false;
	// }, false);


	var queue        = new createjs.LoadQueue(),
			$state       = $('#state'),
			$progress    = $('#progress'),
			$progressbar = $('#progressbar .bar');


	queue.on('complete',     onComplete);
	queue.on('error',        onError);
	queue.on('fileload',     onFileLoad);
	queue.on('fileprogress', onFileProgress);
	queue.on('progress',     onProgress);


/*	queue.loadManifest([
		{
			id:   '1',
			src:  '/local/static/assets/video/Siber_3D.mp4'
		}
	]);*/

	function onComplete(event) {
		// $state.text( $state.text() + '[All loaded]' );
		$progressbar.addClass('complete');

		$preloadFill.height('100%');

		setTimeout(function () {
			if (video) {
				video.play();
			}
			TweenLite.to($preloader, 0.5, {
				top: '0',
				opacity: '0',
				ease: Expo.easeOut
			});
		}, 1000);
	}

	function onError(event) {
		// $state.text( $state.text() + '[' + event.item.id + ' errored] ');
	}

	function onFileLoad(event) {
		// $state.text( $state.text() + '[' + event.item.id + ' loaded] ');
	}

	function onFileProgress(event) {
		// console.log('File progress', event);
	}

	function onProgress(event) {
		var progress = Math.round(event.loaded * 100);

		// console.log('General progress', Math.round(event.loaded) * 100, event);
		$progress.text(progress + '%');
		$progressbar.css({
			'width': progress + '%'
		});
		$preloadFill.height(progress + '%');
	}

});